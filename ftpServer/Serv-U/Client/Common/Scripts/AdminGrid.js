function dzf(glt,nwd,prkb,gmt,zfrb,nvn,dcnb,zgh,qzm){var hpk=new AW.UI.SUAdminGrid(glt,nwd,prkb,qzm);if(hpk!=undefined){hpk.m_XMLTable=new AW.XML.GridTable(zfrb);hpk.setCellModel(hpk.m_XMLTable);hpk.m_sXMLFile=hpk.m_sOrigXMLFile=gmt;hpk.m_sDataNodeName=nvn;hpk.m_nNumColumns=dcnb;hpk.onRowDoubleClicked=zgh;hpk.m_nDeleteColumn=(dcnb-1);hpk.m_nIDCol=hpk.m_nDeleteColumn;hpk.m_sIDCol="ID";hpk.m_ColumnNoResize=[];hpk.setEvent("oncontextmenu","return false");hpk.refresh();bym(hpk);}return(hpk);}function pxcb(hpk,lyy){hpk.Reset(lyy);}function gbg(hpk){hpk.MoveObject(jydb+"Result.xml&Command=MoveTopObject&Object");}function xdm(hpk){hpk.MoveObject(jydb+"Result.xml&Command=MoveUpObject&Object");}function vsv(hpk){hpk.MoveObject(jydb+"Result.xml&Command=MoveDownObject&Object");}function jhg(hpk){hpk.MoveObject(jydb+"Result.xml&Command=MoveBottomObject&Object");}AW.UI.SUAdminGrid=AW.UI.SUBasicGrid.subclass();AW.UI.SUAdminGrid.create=function(){var jd=this.prototype;var ztrb=this.superclass.prototype;jd.init=function(glt,nwd,prkb,dpnb){ztrb.init.call(this,glt,nwd,prkb);var nqqb=0;if(dpnb!=undefined)nqqb=dpnb;this.setSortColumn(nqqb);this.setSortDirection("ascending",nqqb);this.m_nEditObjectID=-1;this.m_bInitialUpdate=true;this.m_nTimerMS=1000;this.m_DisableMove=false;this.m_bFilterMode=false;this.m_bAllowEmpty=false;};jd.NoResizeColumns=function(rbgb){this.m_ColumnNoResize=rbgb;};jd.RightAlignColumn=function(bgz,pqs){var pbhb=new AW.Templates.Text;pbhb.setStyle("text-align","right");this.setCellTemplate(pbhb,bgz);if(pqs)this.getHeaderTemplate(bgz).setStyle("text-align","right");};jd.ChangeURL=function(mtlb){this.m_sXMLFile=this.m_sOrigXMLFile=mtlb;};jd.EnableUpdates=function(ptjb,kjvb,rbg,krsb){if((kjvb!=undefined)&&(rbg!=undefined))this.m_sXMLFile=this.m_sOrigXMLFile.replace(kjvb,rbg);if(krsb)this.m_sOrigXMLFile=this.m_sXMLFile;if((ptjb)&&(!this.m_bUpdates))this.m_nTimeout=this.setTimeout(this.TimeoutFunc,this.m_nTimerMS);else if(!ptjb)clearTimeout(this.m_nTimeout);this.m_bUpdates=ptjb;};jd.TimeoutFunc=function(){var ppjb=(this.m_bInitialUpdate)?"&ForceList=1":"";this.m_XMLTable.setURL(this.m_sXMLFile+ppjb);this.m_XMLTable.request();};jd.ForceUpdate=function(kjvb,rbg){this.m_bForceUpdate=true;if((kjvb!=undefined)&&(rbg!=undefined))this.m_sXMLFile=this.m_sOrigXMLFile.replace(kjvb,rbg);this.TimeoutFunc();};jd.PreUpdateDef=jd.PreUpdate;jd.PreUpdate=function(){var kmw=true;var tvdb=qtdb(this.m_XMLTable.getResponseXML(),"listresult");this.PreUpdateDef();if(!((this.m_bUpdates)||(this.m_bForceUpdate)))kmw=false;else if((this.m_XMLTable.getCount()==1)&&(this.m_XMLTable.getResponseText()=="")){this.setTimeout(this.ForceUpdate);kmw=false;}else if((tvdb!=undefined)&&(tvdb!=0)){if(tvdb==800)this.ResetTimer();kmw=false;}else this.PreserveRowState();this.m_bUpdating=kmw;return(kmw);};jd.PostUpdateDef=jd.PostUpdate;jd.PostUpdate=function(){this.RestoreRowState();this.PostUpdateDef();if(this.m_bSaving)bzh(this.m_bSaving=false);this.m_bInitialUpdate=false;this.ResetTimer();this.m_bUpdating=false;};jd.PreserveRowState=function(){this.m_nCurrentObj=(this.getCurrentRow()>=0)?this.getCellData(this.m_nIDCol,this.getCurrentRow()):-1;if(((this.m_anSelectedObjects=this.getSelectedRows()).length)&&(this.m_anSelectedObjects[0]!=-1)){for(var bynb=0;bynb<this.m_anSelectedObjects.length;bynb++)this.m_anSelectedObjects[bynb]=this.getCellData(this.m_nIDCol,this.m_anSelectedObjects[bynb]);this.m_nScrollLeft=this.getScrollLeft();this.m_nScrollTop=this.getScrollTop();}else this.m_anSelectedObjects=undefined;};jd.RestoreRowState=function(){var scpb=new Array();this.m_bRestoredCurrent=false;if((this.m_anSelectedObjects!=undefined)&&(this.m_anSelectedObjects.length)){for(var bynb=0;bynb<this.m_anSelectedObjects.length;bynb++){var lpx;var srnb=this.m_XMLTable.selectNodes("//"+this.m_sDataNodeName+"["+this.m_sIDCol+"='"+this.m_anSelectedObjects[bynb]+"']");if((srnb.length==1)&&((lpx=this.m_XMLTable.selectNodes("./@listitem",srnb[0])).length==1)){var djgb=(AW.ie)?parseInt(lpx[0].text):parseInt(lpx[0].textContent);this.setRowSelected(true,djgb);scpb.push(djgb);if(this.m_anSelectedObjects[bynb]==this.m_nCurrentObj){this.setCurrentRow(djgb);this.m_nCurrentObj=-1;this.m_bRestoredCurrent=true;}}}this.setSelectedRows(scpb);this.m_anSelectedObjects=undefined;}};jd.ResetCurrentRowDef=jd.ResetCurrentRow;jd.ResetCurrentRow=function(){if(!this.m_bRestoredCurrent)this.setTimeout(this.ResetCurrentRowDef);else this.setTimeout(this.ResetCurrentRowTimeout);};jd.ResetCurrentRowTimeout=function(){this.setScrollLeft(this.m_nScrollLeft);this.setScrollTop(this.m_nScrollTop);this.m_nScrollLeft=this.m_nScrollTop=0;};jd.ResetTimer=function(){if((!this.m_bForceUpdate)&&(this.m_bUpdates))this.m_nTimeout=this.setTimeout(this.TimeoutFunc,this.m_nTimerMS);else this.m_bForceUpdate=false;};jd.EditObject=function(ybnb,skw,vms,vyvb,Form,tkx,xptb,tzfb,xwnb,plq,hgy){var ytpb=new AW.XML.SUObjectTable(ybnb,skw);if(ytpb!=undefined){if(vms)ytpb.setRequestMethod("POST");if(xptb!=undefined){if((xptb.length>=1)&&(xptb[0]!=undefined)){this.m_fnOnFillFormCallback=xptb[0];ytpb.m_fnOnFillForm=this.OnFillFormCallback;ytpb.m_OnFillFormObj=this;}if((xptb.length>=2)&&(xptb[1]!=undefined))ytpb.m_fnDialogDismissal=xptb[1];}if((tzfb!=undefined)&&(tzfb)){this.m_fnOnFillFormCallback=this.CheckErrorState;ytpb.m_fnOnFillForm=this.OnFillFormCallback;ytpb.m_OnFillFormObj=this;ytpb.m_bCheckError=true;}ytpb.FillForm(Form,tkx,xwnb,hgy);}this.m_nEditObjectID=skw;this.m_sDialog=tkx;this.m_Form=Form;this.m_sSaveURL=vyvb;};jd.OnFillFormCallback=function(hpk,ytpb){hpk.UpdateEditObjectID(hpk,ytpb);if(hpk.m_fnOnFillFormCallback!=undefined)hpk.m_fnOnFillFormCallback(hpk,ytpb);};jd.UpdateEditObjectID=function(hpk,ytpb){var srnb=ytpb.GetCollectionByAttrib("var","name","ObjectID");if((srnb!=undefined)&&(srnb.length>0)){var vjk=ytpb.GetNodeValue(srnb[0],"val");if(vjk!=undefined){var skw=parseInt(vjk);hpk.m_nEditObjectID=skw;if(hpk.m_sSaveURL.charAt(hpk.m_sSaveURL.length-1)=='.')hpk.m_sSaveURL+=skw;}}};jd.OnSaveObject=function(hclb,xch,mfgb){var ytpb=new AW.XML.SUObjectTable(this.m_sSaveURL,((this.m_bNewObject)?-1:((this.m_bTempEdit)?this.m_nOriginalEditID:this.m_nEditObjectID)));if(ytpb!=undefined)ytpb.SubmitForm(this.m_Form,this.m_sDialog,hclb,xch,mfgb);};jd.OnAddObject=function(ybnb,vyvb,Form,tkx,xptb,tzfb,xwnb,hgy){this.m_bNewObject=true;this.EditObject(ybnb,0,true,vyvb,Form,tkx,xptb,tzfb,xwnb,undefined,hgy);};jd.OnEditObject=function(ybnb,vyvb,Form,tkx,mgnb,hcb,xptb,wdpb,qvq,xwnb,plq,hgy){if(!qvq){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var jbb=new Array();jbb=this.getSelectedRows().toString().split(",");if(jbb.length==1)qvq=parseInt(this.getCellData((this.m_nNumColumns-1),jbb[0]));else{if(hgy)bzh(false);pkq(mgnb);}}else{if(hgy)bzh(false);pkq(hcb);}}if(qvq){var skw=-1;this.m_bNewObject=false;this.m_nOriginalEditID=qvq;if(wdpb)ybnb+=this.m_nOriginalEditID;else{skw=this.m_nOriginalEditID;if(plq==undefined||!plq)vyvb+=skw;}this.m_bTempEdit=wdpb;this.EditObject(ybnb,skw,false,vyvb,Form,tkx,xptb,undefined,xwnb,plq,hgy);}};jd.OnCopyObject=function(ybnb,vyvb,Form,tkx,mgnb,hcb,xptb,wdpb,qvq){if(!qvq){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var jbb=new Array();jbb=this.getSelectedRows().toString().split(",");if(jbb.length==1)qvq=parseInt(this.getCellData((this.m_nNumColumns-1),jbb[0]));else pkq(mgnb);}else pkq(hcb);}if(qvq){var skw=-1;this.m_bNewObject=true;this.m_nOriginalEditID=qvq;if(wdpb)ybnb+=this.m_nOriginalEditID;else{skw=this.m_nOriginalEditID;vyvb+=skw;}this.m_bTempEdit=wdpb;this.EditObject(ybnb,-1,false,vyvb,Form,tkx,xptb);}};jd.DeleteSelectedObjects=function(hpk,pjg){var jvmb=new Array();var grv=new Array();var nmd=this.m_sAltErrText;grv=this.getSelectedRows().toString().split(",");for(var bynb=0;(bynb<grv.length);bynb++){var skw=this.getCellValue(this.m_nDeleteColumn,grv[bynb]);jvmb.push(skw);}var rqtb=vtf(this.m_sDeleteURL);rqtb.setParameter("IDs",jvmb);rqtb.response=function(){var bzqb=this.getResponseXML();var shcb=kzbb(bzqb,"result");var hqh=qtdb(bzqb,"ResultText");tnc(false);if((shcb!=undefined)&&(shcb!=vzm))txqb(jnv(shcb,nmd,hqh));if(hpk.m_fnOnDeleteDone!=undefined){hpk.m_fnOnDeleteDone(shcb,jvmb);hpk.m_fnOnDeleteDone=undefined;}};rqtb.request(null);if(pjg)tnc(true);else{grcb(nwrb);dwx(kcjb,vvp);}this.setSelectedRows([-1]);};jd.OnDeleteObjects=function(hpk,pjg){if(hpk.m_fnOnConfirmDelete!=undefined){hpk.m_fnOnConfirmDelete();hpk.m_fnOnConfirmDelete=undefined;}hpk.DeleteSelectedObjects(hpk,pjg);};jd.OnDeleteObject=function(tzp,lqcb,hcb,fjtb,hncb,gtc,lbjb){if((this.getSelectedRows()!="")&&(this.getSelectedRows()!=-1)){var grv=new Array();grv=this.getSelectedRows().toString().split(",");if(grv.length>0){this.m_sDeleteURL=jydb+tzp;this.m_sAltErrText=lbjb;this.m_fnOnConfirmDelete=hncb;this.m_fnOnDeleteDone=fjtb;if(lqcb!=undefined)zll(lqcb,this.OnDeleteObjects,gtc,this,undefined,undefined,true);else this.OnDeleteObjects(this,true);}else pkq(hcb);}else pkq(hcb);};jd.InitObjectMove=function(swqb,dyn,scnb){fbmb(swqb,[gbg,xdm,vsv,jhg],this);this.m_asArrowIds=swqb;this.m_sMoveStr=dyn;this.m_fnOnGetEditObj=scnb;this.onSelectedRowsChanged([]);};jd.MoveObject=function(syg){var ypk=this.getSelectedRows();var tkb=this.m_sMoveStr;if((tkb.search(eval("/\\$EDIT_OBJECT_ID\\$/"))>=0)&&(this.m_fnOnGetEditObj!=undefined))tkb=tkb.replace(eval("/\\$EDIT_OBJECT_ID\\$/"),this.m_fnOnGetEditObj());if(ypk.length==1){var dh=this.GetSelectedObjectID();if(dh>0){var mhd=vtf(syg+"="+tkb+"."+dh);hyqb(true);this.m_bSaving=true;mhd.response=function(){var shcb=clkb(this,true);var hqh=qjr(this);if(shcb!=vzm){hyqb(false);this.m_bSaving=false;txqb(jnv(0,"",hqh));}};if(mhd)mhd.request();}}};jd.onSelectedRowsChanged=function(ypk){if(this.m_asArrowIds!=undefined){var hzw=["hidden","hidden"];if((ypk.length==1)&&(ypk[0]!=-1)&&!this.m_DisableMove){if(ypk[0]!=0)hzw[0]="visible";if(ypk[0]!=(this.getRowCount()-1))hzw[1]="visible";}document.getElementById(this.m_asArrowIds[0]).style.visibility=hzw[0];document.getElementById(this.m_asArrowIds[1]).style.visibility=hzw[0];document.getElementById(this.m_asArrowIds[2]).style.visibility=hzw[1];document.getElementById(this.m_asArrowIds[3]).style.visibility=hzw[1];}};jd.GetObjectID=function(pqg,bgz){var khqb=0;for(var bynb=0;bynb<this.getRowCount();bynb++){if(this.getCellText(bgz,bynb)==pqg){khqb=parseInt(this.getCellText((this.m_nNumColumns-1),bynb));break;}}return(khqb);};jd.GetSelectedObjectID=function(){var ypk=this.getSelectedRows();var khqb=-1;if(ypk.length)khqb=parseInt(this.getCellText((this.m_nNumColumns-1),ypk[0]));return(khqb);};jd.DisableSorting=function(jzy){this.m_DisableMove=false;if(this.onHeaderClickedDef==undefined)this.onHeaderClickedDef=this.onHeaderClicked;if(jzy!=undefined)this.onHeaderClicked=function(Event,bynb){jzy(bynb);};else this.onHeaderClicked=function(Event,bynb){return(true);};this.setSortColumn(-1);};jd.EnableSorting=function(){this.m_DisableMove=true;this.onSelectedRowsChanged(-1);this.onHeaderClicked=this.onHeaderClickedDef;this.setSortColumn(1);};jd.Reset=function(lyy){var fyx=this.getSelectionMode();var xtdb=[];for(var bynb=0;bynb<(this.m_nNumColumns-1);bynb++)xtdb[bynb]=this.getCellFormat(bynb);this.saveColSortColumn=this.getSortColumn();this.saveSortDirection=this.getSortDirection(this.getSortColumn());this.clearCurrentModel();this.clearRowModel();this.clearScrollModel();this.clearSelectionModel();this.clearSortModel();this.setSelectionMode(fyx);this.setCellFormat(xtdb);this.m_bInitialUpdate=true;this.refresh();if(lyy)bym(this);};jd.clearScrollModelDef=jd.clearScrollModel;jd.clearScrollModel=function(){if(!this.m_bUpdating)this.clearScrollModelDef();};jd.CheckErrorState=function(ymfb,dbm){var srnb=[];var lkgb=[];var ngn="";var xmfb="";if((srnb=dbm.GetCollectionByAttrib("var","name","Result"))&&(srnb.length)&&((ngn=dbm.GetNodeValue(srnb[0],"val"))!="0")){lkgb=dbm.GetCollectionByAttrib("var","name","ResultText");xmfb=dbm.GetNodeValue(lkgb[0],"val");trc(this.m_sDialog);txqb(jnv(0,"",xmfb),true);}};jd.FilterGrid=function(zcjb,nhj,xjl,svmb){var ghg,qybb=[];this.m_bFilterMode=xjl;this.m_OriginalRowCount=this.m_XMLTable.getCount();this.m_sSearchVal=zcjb;this.m_nColPos=nhj;this.m_bAllowEmpty=(svmb==undefined)?false:svmb;var pbfb="";var xfq=false;var rnsb;var hcc;var cvmb;var cjbb=false;pbfb=zcjb.toLowerCase();hcc=pbfb.length;cvmb=pbfb.indexOf("*");if(cvmb!=-1){xfq=true;}var tzx=pbfb.match(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"));var qz=-1;if(tzx){qz=pbfb.replace(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"),"1").length;}if(qz>-1){hcc=qz;}pbfb=pbfb.replace(eval("/\\./g"),"\\.");pbfb=pbfb.replace(eval("/\\*/g"),"(.*)");pbfb=pbfb.replace(eval("/\\_/g"),"\\_");pbfb=pbfb.replace(eval("/\\?/g"),".");for(ghg=0;ghg<this.m_OriginalRowCount;ghg++){ywlb=this.getCellValue(nhj,ghg);lmq=false;var vqr=false;if(ywlb.toLowerCase().search(eval("/"+pbfb+"/"))==0){if(xfq)vqr=true;else if(ywlb.length==hcc)vqr=true;}if(svmb&&(ywlb==""||ywlb==undefined))vqr=true;if(vqr||pbfb=="")qybb.push(ghg);}this.setRowCount(qybb.length);this.setRowIndices(qybb);};};