%PRIV_GROUP_ADMIN%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<div id="GroupEmailListinner" style="display:none;"><div id="EmailGroups" style="padding:0 5px 0 5px;"><div style="display:inline;"><img alt="$GROUP_EMAIL_LIST_DIALOG_TITLE$" src="%COMMON_FILE%Images/GroupEmail32.png" width="32" height="32" class="header-icon" />$EMAIL_GROUPS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table class=""><tr><td style="vertical-align:top;width:220px;"><span id="EmailGroupsList"></span></td><td style="text-align:center;width:60px;"><div><span id="AddEmailGroupButton"></span></div><div><span id="RemoveEmailGroupButton"></span></div></td><td style="vertical-align:top;width:220px;"><span id="EmailSelectGroupsList"></span></td></tr></table><div style="text-align:right;padding:10px 20px 0 0;"><span id="OKEmailGroupButton"></span><span id="CancelEmailGroupButton"></span></div></div></div><script type="text/javascript" language="javascript">var cjgb;bzb("$GROUP_EMAIL_LIST_DIALOG_TITLE$","GroupEmailList","525","335","","$CLOSE_CANCEL$","GroupEmail16.png");function rsq(sxc){cjgb=sxc[0];yxc.EnableUpdates(false);rwx.setSelectedRows([-1]);xjwb.setSelectedRows([-1]);if(cjgb=="To"){zsp="ToGroupName";xjwb.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","ToGroups.xml&ID="+sfmb);rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+sfmb);}else{zsp="BccGroupName";xjwb.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","BCCGroups.xml&ID="+sfmb);rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+sfmb);}dwx(vvp,"GroupEmailList",bdwb);}function kjg(){if(cjgb=="To"){rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+sfmb);}else{rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+sfmb);}}function xlfb(){if(cjgb=="To"){zsp="ToGroupName";}else{zsp="BccGroupName";}rwx.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+sfmb+"."+zsp,undefined,"$SELECT_ONE_GROUP_EMAIL_DELETE$",kjg);}function bdwb(){rwx.EnableUpdates(false);xjwb.EnableUpdates(false);yxc.EnableUpdates(true);pxcb(rwx,true);pxcb(xjwb,true);}function wjs(){trc('GroupEmailList');rwx.EnableUpdates(false);xjwb.EnableUpdates(false);yxc.EnableUpdates(true);pxcb(rwx,true);pxcb(xjwb,true);}function cqs(){if((xjwb.getSelectedRows()!="")&&(xjwb.getSelectedRows()!=-1)){var jvmb=new Array();var dbc="";vxn=xjwb.getSelectedRows().toString().split(",");for(var bynb=0;(bynb<vxn.length);bynb++){var sdr=xjwb.getCellText(0,vxn[bynb]);jvmb.push(sdr);}if(cjgb=="To"){zsp="ToGroupName";}else{zsp="BccGroupName";}var fcl=vtf("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=CSUEvent."+sfmb+".AddGroupNames");fcl.setParameter("Class","C"+zsp);fcl.setParameter("GroupName",jvmb);fcl.response=function(){var bzqb=this.getResponseXML();var shcb=kzbb(bzqb,"result");var hqh=qtdb(bzqb,"ResultText");hyqb(false);if((shcb!=undefined)&&(shcb!=vzm))txqb(jnv(0,"",hqh));if(cjgb=="To"){rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml&ID="+sfmb);}else{rwx.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml&ID="+sfmb);}};hyqb(true);fcl.request(null);}else txqb("$SELECT_ONLY_ONE_EMAIL_GROUP$");}var srmb=dbfb("","AddEmailGroupButton",cqs,undefined,undefined,undefined,"GreenLeftArrow");var xxj=dbfb("","RemoveEmailGroupButton",xlfb,undefined,undefined,undefined,"GreenRightArrow");srmb.setStyle("visibility","hidden");xxj.setStyle("visibility","hidden");var rwx=dzf("EmailGroupsList",["$GROUP_EMAIL_LIST_DIALOG_TITLE$"],[210],"%GROUP_EMAIL_OBJECT%","groups","group",2);rwx.setStyle("height","200");rwx.onSelectedRowsChangedDef=rwx.onSelectedRowsChanged;rwx.onSelectedRowsChanged=function(ypk){if((ypk.length>=1)&&(ypk[0]!=-1)){xxj.setStyle("visibility","visible");xjwb.setSelectedRows([-1]);}else xxj.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(ypk);};rwx.getCellImage=function(lbz,djgb){return("Group");};var xjwb=dzf("EmailSelectGroupsList",["$SELECT_GROUP_DIALOG_TITLE$"],[210],"%SELECT_GROUP_EMAIL_OBJECT%","groups","group",2,cqs);xjwb.setStyle("height","200");xjwb.onSelectedRowsChangedDef=xjwb.onSelectedRowsChanged;xjwb.onSelectedRowsChanged=function(ypk){if((ypk.length>=1)&&(ypk[0]!=-1)){srmb.setStyle("visibility","visible");rwx.setSelectedRows([-1]);}else srmb.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(ypk);};xjwb.getCellImage=function(lbz,djgb){return("Group");};szpb("$CANCEL_BUTTON$","CancelEmailGroupButton",wjs);szpb("$OK_BUTTON$","OKEmailGroupButton",wjs);</script>